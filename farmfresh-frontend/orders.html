<!DOCTYPE html>
<html>
<head>
  <title>My Orders - FarmFresh</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="script.js" defer></script>
</head>
<body style="
  margin: 0;
  padding: 0;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  color: #333;
  background: url('https://images.pexels.com/photos/95425/pexels-photo-95425.jpeg') center/cover no-repeat fixed;
  min-height: 100vh;
">

  <!-- Overlay for readability -->
  <div style="
    position: fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background: rgba(248,255,254,0.35);
    z-index:-1;
  "></div>

  <!-- Header -->
  <header style="
    background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
    color: white;
    padding: 2rem;
    text-align: center;
    font-family: 'Poppins', sans-serif;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3);
  ">
    <h1 style="margin:0; font-size:2rem;">My Orders</h1>
    <button onclick="logout()" style="
      background: white;
      color: #16a34a;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
    " onmouseover="
      this.style.background='#16a34a';
      this.style.color='white';
      this.style.transform='translateY(-2px)';
      this.style.boxShadow='0 6px 20px rgba(34,197,94,0.5)';
    " onmouseout="
      this.style.background='white';
      this.style.color='#16a34a';
      this.style.transform='translateY(0)';
      this.style.boxShadow='0 4px 12px rgba(34,197,94,0.3)';
    ">Logout</button>
  </header>

  <!-- Orders Container -->
  <main style="max-width: 1200px; margin: 2rem auto; padding: 0 1rem;">
    <div id="ordersContainer" style="
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
    ">
      <!-- Orders will be rendered here -->
    </div>
  </main>

  <script>
    async function loadOrders() {
      const token = getToken();
      if (!token) {
        alert("Please login first!");
        window.location.href = "login.html";
        return;
      }

      try {
        const res = await fetch(`${API_URL}/orders/my`, {
          headers: { Authorization: `Bearer ${token}` }
        });

        if (!res.ok) throw new Error("Failed to fetch orders");

        const data = await res.json();
        const container = document.getElementById("ordersContainer");
        container.innerHTML = "";

        if (data.length === 0) {
          container.innerHTML = "<p style='text-align:center; font-size:1.2rem;'>No orders found.</p>";
          return;
        }

        data.forEach(order => {
          const div = document.createElement("div");
          div.style.cssText = `
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            transition: all 0.3s ease;
          `;
          div.onmouseenter = () => {
            div.style.transform = 'translateY(-5px)';
            div.style.boxShadow = '0 12px 30px rgba(0,0,0,0.15)';
          };
          div.onmouseleave = () => {
            div.style.transform = 'translateY(0)';
            div.style.boxShadow = '0 4px 15px rgba(0,0,0,0.08)';
          };
          div.innerHTML = `
            <h3 style="margin:0 0 0.5rem 0; font-size:1.25rem; color:#374151;">Order ID: ${order._id}</h3>
            <p style="margin:0; color:#6b7280;">Status: ${order.status}</p>
            <p style="margin:0; color:#6b7280;">Total Items: ${order.items.length}</p>
            <ul style="margin:0; padding-left: 1.2rem; color:#374151;">
              ${order.items.map(item => `<li>${item.product?.name || 'Unknown'} x ${item.qty}</li>`).join('')}
            </ul>
          `;
          container.appendChild(div);
        });
      } catch (err) {
        console.error(err);
        alert("Failed to load orders.");
      }
    }

    document.addEventListener("DOMContentLoaded", loadOrders);
  </script>
</body>
</html>












