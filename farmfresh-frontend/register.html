<!DOCTYPE html>
<html>
<head>
  <title>Register - FarmFresh</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="script.js" defer></script>
</head>
<body style="
  margin:0;
  padding:0;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: url('https://images.pexels.com/photos/2252584/pexels-photo-2252584.jpeg') center/cover no-repeat fixed;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
">

  <div style="
    background: rgba(255,255,255,0.95);
    padding: 3rem;
    border-radius:16px;
    box-shadow:0 10px 30px rgba(0,0,0,0.2);
    max-width:400px;
    width:100%;
    text-align:center;
  ">
    <h1 style="margin-bottom:2rem; color:#16a34a; font-family:'Poppins',sans-serif;">Register</h1>

    <form onsubmit="register(event)" style="display:flex; flex-direction:column; gap:1rem;">
      <input type="text" id="name" placeholder="Name" required style="
        padding:1rem;
        border-radius:8px;
        border:1px solid #ccc;
        font-size:1rem;
      ">
      <input type="email" id="email" placeholder="Email" required style="
        padding:1rem;
        border-radius:8px;
        border:1px solid #ccc;
        font-size:1rem;
      ">
      <input type="password" id="password" placeholder="Password" required style="
        padding:1rem;
        border-radius:8px;
        border:1px solid #ccc;
        font-size:1rem;
      ">
      <span id="passwordError" style="color:red; display:none;">
    Password must be at least 6 characters
  </span><br>

      <!-- âœ… Role selection with nice radio buttons -->
      <div style="display:flex; justify-content:center; gap:2rem; margin-top:0.5rem;">
        <label style="display:flex; align-items:center; gap:0.5rem; cursor:pointer;">
          <input type="radio" name="role" value="user" checked style="accent-color:#16a34a;"> User
        </label>
        <label style="display:flex; align-items:center; gap:0.5rem; cursor:pointer;">
          <input type="radio" name="role" value="admin" style="accent-color:#16a34a;"> Admin
        </label>
      </div>

      <button type="submit" style="
        background:#22c55e;
        color:white;
        border:none;
        padding:1rem;
        border-radius:8px;
        font-weight:600;
        cursor:pointer;
        font-size:1rem;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(34,197,94,0.4);
      " onmouseover="
        this.style.background='#16a34a';
        this.style.transform='translateY(-2px)';
        this.style.boxShadow='0 6px 20px rgba(34,197,94,0.6)';
      " onmouseout="
        this.style.background='#22c55e';
        this.style.transform='translateY(0)';
        this.style.boxShadow='0 4px 15px rgba(34,197,94,0.4)';
      ">Register</button>
    </form>

    <p style="margin-top:1rem; color:#6b7280;">Already have an account? <a href="login.html" style="color:#16a34a; font-weight:600;">Login</a></p>
  </div>

  <script>
    async function register(e) {
      e.preventDefault();
      const name = document.getElementById("name").value;
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const role = document.querySelector('input[name="role"]:checked').value;

      const res = await fetch(`${API_URL}/auth/register`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, email, password, role })
      });
      const passwordInput = document.getElementById("password");
  const passwordError = document.getElementById("passwordError");

  passwordInput.addEventListener("input", () => {
    if (passwordInput.value.length < 6) {
      passwordError.style.display = "inline";  // show error instantly
    } else {
      passwordError.style.display = "none";   // hide error
    }
  });

      const data = await res.json();
      if (res.ok) {
        alert("Registered successfully! Please login.");
        window.location.href = "login.html";
      } else {
        alert(data.message || "Registration failed");
      }
    }
  </script>
</body>
</html>
